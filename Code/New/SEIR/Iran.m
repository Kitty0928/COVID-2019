 %SEIR模型
clear;clc;
%参数设置
%%real data
%%US
%confirmed
% 1 2 2 5 5 5 5 5 7 8 8 11 11 12 12 12 12 12 12 13 13 15 15 15 15 15 15 15 15 35 35 35 53 53 59 60 62 70 76 101 121 152 220 277 416 538
%cured
%0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 3, 3, 3, 3, 3 3 3 3 3 3 3 3 5 5 5 5 6 6 6 7 7 7 7 8 8 8 8 8 8
N=8400e4;%人口数
E=2197;%潜伏者
I=139;%初始感染人群
D = 19;
R=49;%初始康复人
S=N-I-R-E-D;%易感染者
r=1.25;%接触病患的人数
a=1/7;%潜伏者患病概率
B=0.105;%感染概率
y=1/12;%康复概率
k=0.003;
T=0:500;
for idx =1:length(T)-1
    S(idx+1)=S(idx)-r*B*I(idx)*S(idx)/N;%易感人数迭代
    E(idx+1)=E(idx)+r*B*S(idx)*I(idx)/N-a*E(idx);%潜伏者人数迭代
    I(idx+1)=I(idx)+a*E(idx)-(y+k)*I(idx);%患病人数迭代
    R(idx+1)=R(idx)+y*I(idx);%康复人数迭代 
    D(idx+1)=D(idx)+k*I(idx);%死亡患者人数迭代
end

%T,S,T,D,
plot(T,I,T,R,T,S,T,E,'LineWidth',5);
grid on;
xlabel('days','LineWidth',5);
ylabel('number of cases','LineWidth',5);
hold on;
data_Infected=[139, 245, 388, 593, 978, 1501, 2336, 2922, 3513, 4747, 5823, 6566, 7161, 8042, 9000, 10075, 11364, 12729, 13938, 14991, 16169, 17361, 18407, 19644, 20610, 21638, 23049, 24811, 27017, 29406, 32332, 35408, 38309, 41495, 44605, 47593, 50468, 53183, 55743, 58226, 60500, 62589, 64586, 66220, 68192, 70029, 71686, 73303, 74877, 76389, 77995, 79494, 80868, 82211, 83505, 84802, 85996, 87026, 88194, 89328, 90481, 91472, 92584, 93657, 94640, 95646, 96448, 97424, 98647, 99970, 101650, 103135, 104691, 106220, 107603, 109286, 110767, 112725, 114533, 116635, 118392, 120198, 122492, 124603, 126949, 129341, 131652, 133521, 135701, 137724, 139511, 141591, 143849, 146668, 148950, 151466, 154445, 157562, 160696, 164270, 167156, 169425, 171789, 173832, 175927, 177938, 180156, 182525, 184955, 187427, 189876, 192439, 195051, 197647, 200262, 202584, 204952, 207525, 209970, 212501, 215096, 217724, 220180, 222669, 225205, 227662, 230211, 232863, 235429, 237878, 240438, 243051, 245688, 248379, 250458, 252720, 255117, 257303, 259652, 262173, 264561, 267061, 269440, 271606, 273788, 276202, 278827, 281413, 284034, 286523, 288839, 291172, 293606, 296273, 298909, 301530, 304204, 306752, 309437, 312035, 314786, 317483, 320117, 322567, 324692, 326712, 328844, 331189, 333699, 336324, 338825, 341070, 343203, 345450, 347835, 350279, 352558, 354764, 356792, 358905, 361150, 363363, 365606, 367796, 369911, 371816, 373570, 375212, 376894, 378752, 380746, 382772, 384666, 386658, 388810, 391112, 393425, 395488, 397801, 399940, 402029, 404648, 407353, 410334, 413149, 416198, 419043, 422140, 425481, 429193, 432798, 436319, 439882, 443086, 446448, 449960, 453637, 457219]';
data_Cured=[49, 49, 73, 123, 175, 291, 291, 552, 739, 913, 1669, 2134, 2394, 2731, 2959, 2959, 2959, 2959, 4590, 4590, 5389, 5389, 5710, 6745, 7635, 7931, 7931, 8913, 9625, 10457, 11133, 11679, 12391, 13911, 14656, 15473, 16711, 17935, 19736, 19736, 24236, 27039, 29812, 32309, 35465, 41947, 43894, 45983, 48129, 49933, 52229, 54064, 55987, 57023, 59273, 60965, 63113, 64843, 66599, 68193, 69657, 70933, 72439, 73791, 75103, 76318, 77350, 78422, 79379, 80475, 81587, 82744, 83837, 85064, 86143, 87422, 88357, 89428, 90539, 91836, 93147, 94464, 95661, 97173, 98808, 100564, 102276, 104072, 105801, 107713, 109437, 111176, 112988, 114931, 116827, 118848, 121004, 123077, 125206, 127485, 129741, 132038, 134349, 136360, 138457, 140590, 142663, 144649, 146748, 148674, 150590, 152675, 154812, 156991, 159192, 161384, 163591, 166427, 169160, 172096, 175103, 177852, 180661, 183310, 186180, 188758, 191487, 194098, 196446, 198949, 201330, 204083, 207000, 209463, 212176, 215015, 217666, 219993, 222539, 225270, 227561, 230608, 232873, 235300, 237788, 240087, 242351, 244840, 247230, 249212, 251319, 253213, 255144, 257019, 259116, 261200, 263519, 265830, 268102, 270228, 272535, 274932, 277463, 279724, 282122, 284371, 286642, 288620, 290244, 292058, 293811, 295630, 297486, 299157, 300881, 302528, 304236, 305866, 307702, 309464, 311365, 313058, 314870, 316638, 318270, 319847, 321421, 323233, 325124, 326801, 328595, 330308, 332131, 333900, 335572, 337414, 339111, 340842, 342539, 344516, 346242, 348013, 349984, 352019, 353848, 355505, 357632, 359570, 361523, 363737, 365846, 367829, 369842, 372051, 374170, 376531, 378727, 380956]';
plot([1:length(data_Infected)]'-1,[data_Infected data_Cured],'*','LineWidth',5);
set(gca,'FontSize',30,'FontWeight','bold');
set(gca,'FontName','Times New Roman');
legend('Infected','Recovered','Susceptible', 'Exposed');
title('Prediction results of Iran','LineWidth',8,'FontWeight','bold');