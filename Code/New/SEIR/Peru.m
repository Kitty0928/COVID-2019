%SEIR模型
clear;clc;
%参数设置
%%real data
%%US
%confirmed
% 1 2 2 5 5 5 5 5 7 8 8 11 11 12 12 12 12 12 12 13 13 15 15 15 15 15 15 15 15 35 35 35 53 53 59 60 62 70 76 101 121 152 220 277 416 538
%cured
%0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 3, 3, 3, 3, 3 3 3 3 3 3 3 3 5 5 5 5 6 6 6 7 7 7 7 8 8 8 8 8 8
N=3.3e7;%人口数
I=117;%传染者
R=20;%康复者
D=1;%死亡患者数量
E=278;%潜伏者
S=N-I-R-E-D;%易感染者
r=1.289;%接触病患的人数
a=1/7.54;%潜伏者患病概率
B=0.1388;%感染概率
y=1/10.5;%康复概率
k=0.0036;
T=0:500;
for idx =1:length(T)-1
    S(idx+1)=S(idx)-r*B*I(idx)*S(idx)/N;%易感人数迭代
    E(idx+1)=E(idx)+r*B*S(idx)*I(idx)/N-a*E(idx);%潜伏者人数迭代
    I(idx+1)=I(idx)+a*E(idx)-(y+k)*I(idx);%患病人数迭代
    R(idx+1)=R(idx)+y*I(idx);%康复人数迭代 
    D(idx+1)=D(idx)+k*I(idx);%死亡患者人数迭代
end

%T,S,T,D,
plot(T,I,T,R,T,S,T,E,'LineWidth',5);
grid on;
xlabel('days','LineWidth',5);
ylabel('number of cases','LineWidth',5);
hold on;
data_Infected=[117, 145, 234, 234, 318, 363, 395, 416, 480, 580, 635, 671, 852, 950, 1065, 1323, 1414, 1595, 1746, 2281, 2561, 2954, 4342, 5256, 5897, 6848, 7519, 9784, 10303, 11475, 12491, 13489, 14420, 15628, 16325, 17837, 19250, 20914, 21648, 25331, 27517, 28699, 31190, 33931, 36976, 40459, 42534, 45928, 47372, 51189, 54817, 58526, 61847, 65015, 67307, 68822, 72059, 76306, 80604, 84495, 88541, 92273, 94933, 99483, 104020, 108769, 111698, 115754, 119959, 123979, 129751, 135905, 141779, 148285, 155671, 164476, 170039, 178165, 178914, 183198, 187400, 191758, 196515, 199696, 203736, 208823, 214788, 214788, 220749, 229736, 232992, 237156, 240908, 244388, 247925, 251338, 254936, 257447, 260810, 264689, 268602, 272364, 275989, 279419, 282365, 285213, 288477, 292004, 295599, 299080, 302718, 305703, 309278, 312911, 316448, 319646, 322710, 326326, 330123, 333867, 337751, 341586, 345537, 349500, 353590, 357681, 362087, 366550, 371096, 375961, 375961, 375961, 389717, 395005, 400683, 400683, 407492, 407492, 428850, 433100, 439890, 447624, 455409, 463875, 463875, 478024, 483133, 489680, 489680, 498555, 516296, 516296, 525803, 535946, 541493, 549321, 558420, 567059, 576067, 585236, 594326, 600438, 607382, 613378, 621997, 629961, 639435, 647166, 652037, 657129, 657129, 670145, 676848, 683702, 689977, 691575, 696190, 702776, 710067, 716670, 722832, 729619, 733860, 738020, 744400, 750098, 756412, 762865, 768895, 768895, 776546, 782695, 794584, 794584, 800142, 805302, 808714, 811768]';

data_Cured=[0, 0, 0, 3, 5, 5, 5, 7, 9, 9, 11, 16, 18, 24, 30, 38, 55, 61, 73, 83, 92, 107, 121, 138, 169, 181, 193, 216, 230, 254, 274, 300, 348, 400, 445, 484, 530, 572, 634, 700, 728, 782, 854, 943, 1051, 1124, 1200, 1286, 1344, 1444, 1533, 1627, 1714, 1814, 1889, 1961, 2057, 2169, 2267, 2392, 2523, 2648, 2789, 2914, 3024, 3148, 3244, 3373, 3456, 3629, 3788, 3983, 4099, 4230, 4371, 4506, 4634, 4767, 4894, 5031, 5162, 5301, 5465, 5571, 5738, 5903, 6088, 6088, 6308, 6688, 6860, 7056, 7257, 7461, 7660, 7861, 8045, 8223, 8404, 8586, 8761, 8939, 9135, 9317, 9504, 9677, 9860, 10045, 10226, 10412, 10589, 10772, 10952, 11133, 11314, 11500, 11682, 11870, 12054, 12229, 12417, 12615, 12799, 12998, 13187, 13384, 13579, 13767, 17654, 17843, 17843, 17843, 18418, 18612, 18816, 18816, 19021, 19021, 19614, 19811, 20007, 20228, 20424, 20649, 20649, 21072, 21276, 21501, 21501, 21713, 25856, 25856, 26075, 26281, 26481, 26658, 26834, 27034, 27245, 27453, 27663, 27813, 28001, 28124, 28277, 28471, 28607, 28788, 28944, 29068, 29068, 29405, 29554, 29687, 29838, 29976, 30123, 30236, 30344, 30470, 30526, 30710, 30812, 30927, 31051, 31146, 31283, 31369, 31369, 31369, 31568, 31870, 32037, 32037, 32142, 32262, 32324, 32396]';
plot([1:length(data_Infected)]'-1,[data_Infected data_Cured],'*','LineWidth',5);
set(gca,'FontSize',30,'FontWeight','bold');
set(gca,'FontName','Times New Roman');
legend('Infected','Recovered','Susceptible', 'Exposed');
title('Prediction results of Peru','LineWidth',8,'FontWeight','bold');

% I=round(I);
% R = round(R);
% csvwrite('./csvI.csv',I);
% csvwrite('./csvD.csv',D);
% csvwrite('./csvR.csv',R);