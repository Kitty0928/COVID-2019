%SEIR模型
clear;clc;
%参数设置
%%real data
%%US
%confirmed
% 1 2 2 5 5 5 5 5 7 8 8 11 11 12 12 12 12 12 12 13 13 15 15 15 15 15 15 15 15 35 35 35 53 53 59 60 62 70 76 101 121 152 220 277 416 538
%cured
%0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 3, 3, 3, 3, 3 3 3 3 3 3 3 3 5 5 5 5 6 6 6 7 7 7 7 8 8 8 8 8 8
N=212559417;%人口数
I=151;%感染者
R=0;%康复者
D=0;%死亡患者数量
E=210;%潜伏者
S=N-I-R-E-D;%易感染者

r=1.26;%接触病患的人数
a=1/7;%潜伏者患病概率
B=0.127;%感染概率
y=1/15;%康复概率
k=0.0048;
T=0:500;
for idx =1:length(T)-1
    S(idx+1)=S(idx)-r*B*I(idx)*S(idx)/N;%易感人数迭代
    E(idx+1)=E(idx)+r*B*S(idx)*I(idx)/N-a*E(idx);%潜伏者人数迭代
    I(idx+1)=I(idx)+a*E(idx)-(y+k)*I(idx);%患病人数迭代
    R(idx+1)=R(idx)+y*I(idx);%康复人数迭代 
    D(idx+1)=D(idx)+k*I(idx);%死亡患者人数迭代
end

%T,S,T,D,
plot(T,I,T,R,T,S,T,E,'LineWidth',5);
grid on;
xlabel('days','LineWidth',5);
ylabel('number of cases','LineWidth',5);
hold on;
data_Infected=[151, 151, 162, 200, 321, 372, 621, 793, 1021, 1546, 1924, 2247, 2554, 2985, 3417, 3904, 4256, 4579, 5717, 6836, 8044, 9056, 10360, 11130, 12161, 14034, 16170, 18092, 19638, 20727, 22192, 23430, 25262, 28320, 30425, 33682, 36658, 38654, 40743, 43079, 45757, 50036, 54043, 59324, 63100, 67446, 73235, 79685, 87187, 92202, 97100, 101826, 108620, 115455, 126611, 135773, 146894, 156061, 162699, 169594, 178214, 190137, 203165, 220291, 233511, 241080, 255368, 271885, 291579, 310087, 330890, 347398, 363211, 374898, 391222, 411821, 438238, 465166, 498440, 514849, 526447, 555383, 584016, 614941, 645771, 672846, 691758, 707412, 739503, 772416, 802828, 828810, 850514, 867624, 888271, 923189, 955377, 978142, 1032913, 1067579, 1083341, 1106470, 1145906, 1188631, 1228114, 1274974, 1313667, 1344143, 1368195, 1402041, 1448753, 1496858, 1539081, 1577004, 1603055, 1623284, 1668589, 1713160, 1755779, 1800827, 1839850, 1864681, 1884967, 1926824, 1966748, 2012151, 2046328, 2074860, 2098389, 2118646, 2159654, 2227514, 2287475, 2343366, 2394513, 2419091, 2442375, 2483191, 2552265, 2610102, 2662485, 2707877, 2733677, 2750318, 2801921, 2859073, 2912212, 2962442, 3012412, 3035422, 3057470, 3109630, 3164785, 3224876, 3275520, 3317096, 3340197, 3359570, 3407354, 3456652, 3501975, 3532330, 3582362, 3605783, 3622861, 3669995, 3717156, 3761391, 3804803, 3846153, 3862311, 3908272, 3950931, 3997865, 4041638, 4091801, 4123000, 4137521, 4147794, 4162073, 4197889, 4238446, 4282164, 4315687, 4330455, 4345610, 4382263, 4419083, 4455386, 4495183, 4528240, 4544629, 4558040, 4591364, 4591364, 4657702, 4689613, 4717991, 4732309, 4745464, 4777522, 4810935]';
data_Cured=[0, 0, 0, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 6, 6, 6, 6, 120, 127, 127, 127, 127, 127, 127, 127, 127, 127, 173, 173, 173, 173, 173, 3046, 14026, 14026, 14026, 14026, 22130, 22130, 22991, 25318, 26573, 27655, 29160, 30152, 31142, 32544, 34132, 35935, 38039, 40937, 42991, 45815, 48221, 51370, 55350, 59297, 61685, 64957, 67384, 72597, 78424, 79479, 84970, 89672, 94122, 100459, 106794, 116683, 125960, 135430, 142587, 149911, 153833, 158593, 166647, 177604, 189476, 200892, 206555, 211080, 223638, 238617, 254963, 266940, 277149, 283952, 378257, 396737, 413916, 429965, 445123, 459436, 469141, 477709, 490005, 521046, 534580, 551631, 576779, 588118, 601736, 627963, 660469, 679524, 702399, 727715, 746018, 757811, 788318, 817642, 957692, 984615, 990731, 1029045, 1062542, 1107012, 1139844, 1171447, 1217361, 1244088, 1264843, 1291251, 1323425, 1350098, 1397531, 1428520, 1447408, 1459072, 1514300, 1555339, 1591975, 1620313, 1693214, 1785359, 1812913, 1846641, 1868749, 1922802, 1956807, 2008854, 2037982, 2062876, 2098976, 2157484, 2190361, 2230542, 2272299, 2321537, 2356983, 2390830, 2449338, 2506228, 2521100, 2616981, 2622878, 2655017, 2699080, 2751246, 2801931, 2844318, 2855558, 2913966, 2947784, 2976256, 3032551, 3082447, 3122846, 3158783, 3202185, 3237615, 3268591, 3345240, 3387309, 3429435, 3464278, 3498999, 3522155, 3549201, 3572421, 3611632, 3657701, 3695158, 3723206, 3723206, 3770138, 3811505, 3845464, 3873934, 3897539, 3936893, 3963446, 3993432, 4016831, 4046827, 4102954, 4128490, 4153307, 4172711, 4197372, 4237152, 4274774]';


% data_Infected=[22192, 23430, 25262, 28320, 30425, 33682, 36658, 38654, 40743, 43079, 45757, 50036, 54043, 59324, 63100, 67446, 73235, 79685, 87187, 92202, 97100, 101826, 108620, 115455, 126611, 135773, 146894, 156061, 162699, 169594, 178214, 190137, 203165, 220291, 233511, 241080, 255368, 271885, 291579, 310087, 330890, 347398, 363211, 374898, 391222, 411821, 438238, 465166, 498440, 514849, 526447, 555383, 584016, 614941, 645771, 672846, 691758, 707412, 739503, 772416, 802828, 828810, 850514, 867624, 888271, 923189, 955377, 978142, 1032913, 1067579, 1083341, 1106470, 1145906, 1188631, 1228114, 1274974, 1313667, 1344143, 1368195, 1402041, 1448753, 1496858, 1539081, 1577004, 1603055, 1623284, 1668589, 1713160, 1755779, 1800827, 1839850, 1864681, 1884967, 1926824, 1966748, 2012151, 2046328, 2074860, 2098389, 2118646]';
% data_Cured=[173, 173, 3046, 14026, 14026, 14026, 14026, 22130, 22130, 22991, 25318, 26573, 27655, 29160, 30152, 31142, 32544, 34132, 35935, 38039, 40937, 42991, 45815, 48221, 51370, 55350, 59297, 61685, 64957, 67384, 72597, 78424, 79479, 84970, 89672, 94122, 100459, 106794, 116683, 125960, 135430, 142587, 149911, 153833, 158593, 166647, 177604, 189476, 200892, 206555, 211080, 223638, 238617, 254963, 266940, 277149, 283952, 378257, 396737, 413916, 429965, 445123, 459436, 469141, 477709, 490005, 521046, 534580, 551631, 576779, 588118, 601736, 627963, 660469, 679524, 702399, 727715, 746018, 757811, 788318, 817642, 957692, 984615, 990731, 1029045, 1062542, 1107012, 1139844, 1171447, 1217361, 1244088, 1264843, 1291251, 1323425, 1350098, 1397531, 1428520, 1447408, 1459072, 1514300]';
% 


plot([1:length(data_Infected)]'-1,[data_Infected data_Cured],'*','LineWidth',5);
set(gca,'FontSize',30,'FontWeight','bold');
set(gca,'FontName','Times New Roman');
legend('Infected','Recovered','Susceptible', 'Exposed');
title('Prediction results of Brazil','LineWidth',8,'FontWeight','bold')
