%SEIR模型
clear;clc;
%参数设置
%%real data
%%US
%confirmed
% 1 2 2 5 5 5 5 5 7 8 8 11 11 12 12 12 12 12 12 13 13 15 15 15 15 15 15 15 15 35 35 35 53 53 59 60 62 70 76 101 121 152 220 277 416 538
%cured
%0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 3, 3, 3, 3, 3 3 3 3 3 3 3 3 5 5 5 5 6 6 6 7 7 7 7 8 8 8 8 8 8
%0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 3, 3, 3, 3, 3 3 3 3 3 3 3 3 5 5 5 5 6 6 6 7 7 7 7 8 8 8 8 8 8
N=5.09e7;%人口数
I=102;%感染者
R=0;%康复者
D=1;%死亡患者数量
E=276;%潜伏者
S=N-I-R-E-D;%易感染者
r=1.38;%接触病患的人数
a=1/6;%潜伏者患病概率
B=0.139;%感染概率
y=1/9;%康复概率
k=0.005;%死亡概率
T=0:500;
for idx =1:length(T)-1
    S(idx+1)=S(idx)-r*B*I(idx)*S(idx)/N;%易感人数迭代
    E(idx+1)=E(idx)+r*B*S(idx)*I(idx)/N-a*E(idx);%潜伏者人数迭代
    I(idx+1)=I(idx)+a*E(idx)-(y+k)*I(idx);%患病人数迭代
    R(idx+1)=R(idx)+y*I(idx);%康复人数迭代 
    D(idx+1)=D(idx)+k*I(idx);%死亡患者人数迭代
end

%T,S,T,D,
plot(T,I,T,R,T,S,T,E,'LineWidth',5);
grid on;
xlabel('days','LineWidth',5);
ylabel('number of cases','LineWidth',5);
hold on;
data_Infected=[ 102, 108, 158, 196, 231, 277, 378, 470, 491, 539, 608, 702, 798, 906, 1065, 1161, 1267, 1406, 1485, 1579, 1780, 2054, 2223, 2473, 2709, 2776, 2852, 2979, 3105, 3233, 3439, 3621, 3792, 3977, 4149, 4356, 4561, 4881, 5142, 5379, 5597, 5949, 6207, 6507, 7006, 7285, 7668, 7973, 8613, 8959, 9456, 10051, 10495, 11063, 11613, 12272, 12930, 13610, 14216, 14939, 15574, 16295, 16935, 17687, 18330, 19131, 20177, 21175, 21981, 23003, 24104, 25366, 26688, 28236, 29383, 30493, 31833, 33354, 35120, 36635, 38027, 39236, 40719, 42078, 43682, 45212, 46858, 48746, 50939, 53063, 54931, 57046, 60217, 63276, 65633, 68652, 71183, 73572, 77113, 80599, 84442, 88591, 91769, 95043, 97846, 102009, 106110, 109505, 113389, 117110, 120281, 124494, 128638, 133973, 140776, 145632, 150445, 154277, 159898, 165169, 173206, 182140, 190700, 197278, 204005, 211038, 218428, 226373, 233541, 240795, 248976, 257101, 267385, 276055, 286020, 295508, 306181, 317651, 327850, 334979, 345714, 357710, 367204, 376870, 387481, 397623, 410453, 422519, 433805, 445111, 456689, 468332, 476660, 489122, 502178, 513719, 522138, 533103, 541139, 551688, 562113, 572243, 581995, 590492, 599884, 607904, 615094, 624026, 633321, 641574, 650063, 658456, 666521, 671848, 671533, 686851, 694664, 702088, 708964, 716319, 721892, 728590, 736377, 743945, 750471, 758398, 765076, 770435, 777537, 784268, 790823, 798317, 806038, 813056, 818203, 824042, 829679]';
data_Cured=[ 0, 0, 0, 0, 2, 3, 3, 4, 6, 6, 6, 10, 12, 16, 17, 19, 25, 32, 35, 46, 50, 54, 69, 80, 100, 109, 112, 127, 131, 144, 153, 166, 179, 189, 196, 206, 215, 225, 233, 244, 253, 269, 278, 293, 314, 324, 340, 358, 378, 397, 407, 428, 445, 463, 479, 493, 509, 525, 546, 562, 574, 592, 613, 630, 652, 682, 705, 727, 750, 776, 803, 822, 853, 890, 939, 969, 1009, 1045, 1087, 1145, 1205, 1259, 1308, 1372, 1433, 1488, 1545, 1592, 1667, 1726, 1801, 1864, 1950, 2045, 2126, 2237, 2310, 2404, 2491, 2654, 2811, 2939, 3178, 3274, 3334, 3470, 3641, 3777, 3942, 4064, 4210, 4359, 4527, 4714, 4925, 5119, 5307, 5455, 5625, 5814, 6029, 6288, 6516, 6736, 6929, 7166, 7373, 7688, 7975, 8269, 8525, 8777, 9074, 9454, 9810, 10105, 10330, 10650, 11017, 11315, 11624, 11939, 12250, 12540, 12842, 13154, 13475, 13837, 14145, 14492, 14810, 15097, 15372, 15619, 15979, 16183, 16568, 16968, 17316, 17612, 17889, 18184, 18467, 18766, 19063, 19363, 19662, 20050, 20345, 20618, 20888, 21156, 21412, 21615, 21611, 22053, 22275, 22518, 22734, 22924, 23123, 23288, 23478, 23665, 23665, 24039, 24208, 24397, 24397, 24746, 24746, 25103, 25296, 25488, 25641, 25828, 25998]';

plot([1:length(data_Infected)]'-1,[data_Infected data_Cured],'*','LineWidth',5);
set(gca,'FontSize',30,'FontWeight','bold');
set(gca,'FontName','Times New Roman');
legend('Infected','Recovered','Susceptible', 'Exposed');
title('Prediction results of Colombia','LineWidth',8,'FontWeight','bold');

% D =round(D)
% I=round(I);
% R = round(R);
% csvwrite('./csvI.csv',I);
% csvwrite('./csvD.csv',D);
% csvwrite('./csvR.csv',R);