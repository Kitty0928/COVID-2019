
%SEIR模型
clear;clc;
%参数设置
%%real data
%%Italy
%confirmed
%155 229 322 453 655 888 1128 1694 2036 2502 3089 3858
%cured
%1 1 2 3 45 46 46 83 149 160 276 414
N=3107e4;%人口数
I=132;%传染者
R=4;%康复者
D=1;%死亡患者数量
E=63;%潜伏者
S=N-I-R-E-D;%易感染者
c=1.31;%接触病患的人数
a=1/7;%潜伏者患病概率
B=0.105;%感染概率
y=1/14;%康复概率
k=0.003;
T=0:500;
for idx =1:length(T)-1
    S(idx+1)=S(idx)-c*B*I(idx)*S(idx)/N;%易感人数迭代
    E(idx+1)=E(idx)+c*B*S(idx)*I(idx)/N-a*E(idx);%潜伏者人数迭代
    I(idx+1)=I(idx)+a*E(idx)-(y+k)*I(idx);%患病人数迭代
    R(idx+1)=R(idx)+y*I(idx);%康复人数迭代 
    D(idx+1)=D(idx)+k*I(idx);%死亡患者人数迭代
end
% T,S,T,D,
plot(T,I,T,R,T,S,T,E,'LineWidth',5);
grid on;
xlabel('days','LineWidth',5);
ylabel('number of cases','LineWidth',5);
hold on;
data_Infected=[190, 228, 331, 331, 387, 418, 418, 495, 530, 624, 695, 743, 821, 892, 966, 1061, 1156, 1212, 1314, 1415, 1544, 1613, 1673, 1735, 1755, 1832, 1884, 1955, 2011, 2081, 2114, 2145, 2170, 2192, 2207, 2224, 2235, 2235, 2245, 2401, 2408, 2463, 2490, 2506, 2517, 2534, 2566, 2576, 2591, 2612, 2620, 2626, 2632, 2642, 2663, 2678, 2691, 2710, 2716, 2726, 2744, 2760, 2770, 2810, 2819, 2834, 2836, 2840, 2850, 2853, 2874, 2876, 2878, 2882, 2892, 2903, 2906, 2909, 2915, 2917, 2918, 2937, 2937, 2952, 2967, 2980, 2997, 3049, 3058, 3068, 3088, 3108, 3112, 3121, 3134, 3148, 3203, 3227, 3237, 3256, 3266, 3287, 3302, 3310, 3321, 3343, 3366, 3376, 3390, 3409, 3432, 3458, 3486, 3511, 3519, 3562, 3589, 3622, 3672, 3732, 3772, 3803, 3826, 3883, 3910, 3939, 3964, 3983, 4007, 4012, 4048, 4077, 4110, 4135, 4166, 4193, 4227, 4279, 4336, 4401, 4477, 4587, 4662, 4737, 4855, 4974, 5123, 5270, 5421, 5623, 5749, 5942, 6177, 6381, 6632, 6858, 7075, 7222, 7472, 7684, 7934, 8138, 8381, 8664, 8819, 8987, 9280, 9531, 9800, 9977, 10134, 10317, 10524, 10757, 10998, 11200, 11386, 11524, 11663, 11832, 12080, 12452, 12734, 13036, 13240, 13420, 13730, 14041, 14400, 14738, 14978, 15142, 15595, 15928, 16286, 16627, 16913, 17228, 17444, 17707, 18123, 18475]
    
data_Cured=[4, 4, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 6, 6, 6, 8, 8, 8, 8, 8, 8, 8, 9, 9, 9, 9, 9, 9, 10, 10, 11, 11, 16, 16, 17, 17, 18, 18, 18, 18, 18, 18, 18, 22, 22, 22, 22, 24, 24, 28, 29, 29, 29, 31, 31, 31, 31, 31, 32, 32, 34, 34, 34, 34, 35, 36, 36, 38, 38, 38, 42, 44, 44, 48, 48, 48, 48, 48, 48, 54, 54, 58, 66, 66, 70, 85, 85, 85, 95, 95, 95, 103, 103, 112, 112, 112, 117, 117, 117, 117, 122, 129, 129, 129, 129, 135, 135, 139, 139, 139, 139, 139, 144, 145, 148, 153, 153, 153, 153, 161, 161, 168, 168, 168, 175, 175, 182, 182, 182, 191, 191, 199, 199, 206, 206, 215, 215, 215, 223, 223, 223, 231, 231, 239, 248, 256, 261, 261, 261, 261, 263, 270, 270, 270, 270, 270, 276, 276, 276, 276, 280, 283, 283, 283, 283, 283, 283, 283, 285, 286, 286, 294, 294, 294, 294, 295, 297, 297, 297, 297, 299, 299, 299, 299, 299, 299, 301, 301]';
plot([1:length(data_Infected)]'-1,[data_Infected data_Cured],'*','LineWidth',5);
set(gca,'FontSize',30,'FontWeight','bold');
set(gca,'FontName','Times New Roman');
legend('Infected','Recovered','Susceptible', 'Exposed');
title('Prediction results of Ghana','LineWidth',8,'FontWeight','bold');