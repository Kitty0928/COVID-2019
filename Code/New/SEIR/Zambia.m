%SEIR模型
clear;clc;
%参数设置
%%real data
%%US
%confirmed
% 1 2 2 5 5 5 5 5 7 8 8 11 11 12 12 12 12 12 12 13 13 15 15 15 15 15 15 15 15 35 35 35 53 53 59 60 62 70 76 101 121 152 220 277 416 538
%cured
%0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 3, 3, 3, 3, 3 3 3 3 3 3 3 3 5 5 5 5 6 6 6 7 7 7 7 8 8 8 8 8 8
N=1.8e7;%人口数
I=106;%感染者
R=55;%康复者
D=3;%死亡患者数量
E=40;%潜伏者
S=N-I-R-E;%易感染者
r=1.51;%接触病患的人数
a=1/7;%潜伏者患病概率
B=0.125;%感染概率
y=1/10;%康复概率
k=0.004373;
T=0:500;
for idx =1:length(T)-1
    S(idx+1)=S(idx)-r*B*I(idx)*S(idx)/N;%易感人数迭代
    E(idx+1)=E(idx)+r*B*S(idx)*I(idx)/N-a*E(idx);%潜伏者人数迭代
    I(idx+1)=I(idx)+a*E(idx)-(y+k)*I(idx);%患病人数迭代
    R(idx+1)=R(idx)+y*I(idx);%康复人数迭代 
    D(idx+1)=D(idx)+k*I(idx);%死亡患者人数迭代
end

%T,S,T,E,T,D,
plot(T,I,T,R,T,S,T,E,'LineWidth',5);
grid on;
xlabel('days','LineWidth',5);
ylabel('number of cases','LineWidth',5);
hold on;
data_Infected=[106, 109, 119, 124, 137, 138, 146, 153, 167, 252, 267, 267, 441, 446, 654, 654, 679, 753, 761, 772, 832, 866, 920, 920, 920, 920, 920, 1057, 1057, 1057, 1057, 1057, 1089, 1089, 1089, 1089, 1089, 1089, 1089, 1200, 1200, 1200, 1200, 1321, 1357, 1358, 1382, 1405, 1412, 1416, 1430, 1430, 1430, 1430, 1477, 1489, 1497, 1531, 1531, 1557, 1568, 1594, 1632, 1632, 1632, 1632, 1632, 1632, 1895, 1895, 1895, 1895, 1895, 1895, 1895, 1895, 1895, 1895, 2810, 2980, 2980, 3326, 3386, 3583, 3789, 3856, 4328, 4481, 4552, 5002, 5249, 5555, 5963, 6228, 6347, 6580, 6793, 7022, 7164, 7486, 7903, 8085, 8210, 8275, 8501, 8663, 9021, 9186, 9343, 9839, 9981, 10218, 10372, 10627, 10831, 11082, 11148, 11285, 11376, 11601, 11779, 11902, 12025, 12097, 12381, 12415, 12523, 12639, 12709, 12776, 12836, 12952, 13112, 13214, 13323, 13466, 13539, 13720, 13819, 13887, 13928, 14022, 14070, 14131, 14175, 14389, 14443, 14491, 14515, 14612, 14641, 14660, 14715, 14759]';
data_Cured=[55, 74, 75, 78, 78, 92, 101, 103, 111, 112, 117, 117, 117, 124, 124, 124, 183, 188, 192, 192, 197, 302, 336, 336, 336, 336, 336, 779, 779, 779, 779, 779, 912, 912, 912, 912, 912, 912, 912, 912, 912, 912, 912, 1104, 1104, 1122, 1142, 1142, 1142, 1144, 1194, 1194, 1194, 1194, 1213, 1223, 1223, 1233, 1233, 1311, 1311, 1329, 1348, 1348, 1348, 1348, 1348, 1348, 1348, 1348, 1348, 1348, 1348, 1412, 1412, 1412, 1412, 1412, 1450, 1462, 1462, 1620, 1620, 1677, 1677, 1677, 1953, 2350, 2815, 3195, 3285, 3289, 3803, 4130, 4493, 4701, 5109, 5667, 5786, 6264, 6431, 6698, 6802, 7004, 7233, 7401, 7586, 8065, 8412, 8575, 8776, 9126, 9126, 9126, 9942, 9942, 10208, 10400, 10693, 10840, 10945, 11092, 11454, 11469, 11479, 11494, 11562, 11572, 11668, 11674, 11748, 11787, 11839, 11899, 11899, 12007, 12260, 12380, 12590, 12869, 13029, 13207, 13365, 13365, 13629, 13629, 13629, 13643, 13643, 13727, 13784, 13821, 13937, 13959]';

plot([1:length(data_Infected)]'-1,[data_Infected data_Cured],'*','LineWidth',5);
set(gca,'FontSize',30,'FontWeight','bold');
set(gca,'FontName','Times New Roman');
legend('Infected','Recovered','Susceptible', 'Exposed');
title('Prediction results of Zambia','LineWidth',8,'FontWeight','bold');