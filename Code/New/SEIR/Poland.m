%SEIR模型
clear;clc;
%参数设置
%%real data
%%US
%confirmed
% 1 2 2 5 5 5 5 5 7 8 8 11 11 12 12 12 12 12 12 13 13 15 15 15 15 15 15 15 15 35 35 35 53 53 59 60 62 70 76 101 121 152 220 277 416 538
%cured
%0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 3, 3, 3, 3, 3 3 3 3 3 3 3 3 5 5 5 5 6 6 6 7 7 7 7 8 8 8 8 8 8
N=8.4e7;%人口数
I=192;%感染者
R=0;%康复者
D=0;%死亡患者数量
E=2241;%潜伏者
S=N-I-R-E;%易感染者
r=1.38;%接触病患的人数
a=1/8;%潜伏者患病概率
B=0.125;%感染概率
y=1/9.5;%康复概率
k=0.004873;
T=0:500;
for idx =1:length(T)-1
    S(idx+1)=S(idx)-r*B*I(idx)*S(idx)/N;%易感人数迭代
    E(idx+1)=E(idx)+r*B*S(idx)*I(idx)/N-a*E(idx);%潜伏者人数迭代
    I(idx+1)=I(idx)+a*E(idx)-(y+k)*I(idx);%患病人数迭代
    R(idx+1)=R(idx)+y*I(idx);%康复人数迭代 
    D(idx+1)=D(idx)+k*I(idx);%死亡患者人数迭代
end

%T,S,T,E,
plot(T,I,T,R,T,S,T,E,'LineWidth',5);
grid on;
xlabel('days','LineWidth',5);
ylabel('number of cases','LineWidth',5);
hold on;
data_Infected=[192, 359, 670, 1236, 1529, 1872, 2433, 3629, 5698, 7402, 9217, 10827, 13531, 15679, 18135, 20921, 23934, 27069, 30217, 34109, 38226, 42282, 47029, 52167, 56956, 61049, 65111, 69392, 74193, 78546, 82329, 86306, 90980, 95591, 98674, 101790, 104912, 107773, 110130, 112261, 114653, 117589, 120204, 122392, 124375, 126045, 127659, 129491, 131744, 133721, 135569, 137115, 138657, 139771, 141475, 143114, 144749, 146457, 148067, 149435, 150593, 151615, 152587, 153548, 154500, 155686, 156827, 157814, 158762, 159797, 160979, 162120, 163103, 163942, 164769, 165555, 166422, 167410, 168340, 169218, 170132, 171121, 172114, 173036, 174023, 175218, 176677, 178239, 179831, 181298, 182727, 184031, 185245, 186493, 187685, 188897, 190165, 191657, 193115, 194511, 195883, 197239, 198613, 199906, 201098, 202284, 203456, 204610, 205758, 206844, 207897, 208938, 209962, 210965, 211981, 212993, 214001, 214993, 215940, 216873, 217799, 218717, 219641, 220572, 221500, 222402, 223315, 224252, 225173, 226100, 227019, 227982, 228924, 229891, 230873, 231869, 232856, 233851, 234934, 236112, 237265, 238450, 239622, 240804, 241997, 243180, 244392, 245635, 246861, 248117, 249309, 250542, 251805, 253108, 254520, 255723, 257032, 258249, 259692, 261194, 262507, 263998, 265515, 267064, 268546, 270133, 271705, 273301, 274943, 276555, 278228, 279806, 281509, 283270, 284943, 286455, 288126, 289635, 291162, 292878, 294620, 296391, 298039, 299810, 301348, 302867, 304610, 306302, 308069, 309790, 311455, 312966, 314433, 315845, 317272, 318663]';
data_Cured=[0, 0, 0, 0, 0, 0, 26, 26, 42, 70, 105, 162, 243, 333, 415, 484, 786, 1042, 1326, 1582, 1846, 2142, 2423, 2965, 3446, 3957, 4799, 5674, 7089, 8631, 10453, 11976, 13430, 14918, 16477, 18491, 21737, 25582, 29140, 33791, 38809, 44040, 48886, 53808, 58259, 63151, 68166, 73285, 78202, 82984, 86396, 89480, 92691, 95780, 98889, 101715, 104030, 106133, 108137, 109962, 111577, 112895, 113987, 114990, 116111, 117602, 118694, 120015, 121507, 122793, 124369, 125963, 126984, 127973, 128947, 129921, 130852, 131778, 133400, 135322, 137969, 141380, 144598, 146839, 147860, 149102, 150087, 151417, 152364, 153379, 154640, 156022, 157516, 158828, 160240, 161533, 162848, 164234, 165706, 167198, 169182, 170595, 171809, 173111, 175422, 176965, 178278, 179492, 180680, 182995, 185292, 187511, 190390, 191883, 193217, 194515, 195671, 196720, 197733, 198820, 199834, 201013, 202010, 203002, 204011, 205214, 206365, 207374, 208477, 209487, 210469, 211561, 212557, 213539, 214535, 215516, 216494, 217497, 218491, 219506, 220546, 221574, 222656, 223759, 224970, 226155, 227089, 228057, 228980, 229972, 230969, 231971, 232913, 233915, 234797, 235569, 236370, 237165, 237908, 238795, 239797, 240792, 241809, 242812, 243839, 244926, 245929, 246876, 248087, 249108, 250092, 251105, 252152, 253245, 254188, 255407, 256524, 257731, 258833, 260058, 261260, 262602, 263745, 264805, 266117, 267233, 268435, 269696, 270723, 271964, 273282, 274514, 275630, 277052, 278504, 279749]';

plot([1:length(data_Infected)]'-1,[data_Infected data_Cured],'*','LineWidth',5);
set(gca,'FontSize',30,'FontWeight','bold');
set(gca,'FontName','Times New Roman');
legend('Infected','Recovered','Susceptible', 'Exposed');
title('Prediction results of Turkey','LineWidth',8,'FontWeight','bold');